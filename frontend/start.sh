#!/bin/bash

# сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅУхитІЋсѓ╣сѓ»сЃфсЃЌсЃѕ

echo "­Ъџђ сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓбсЃЌсЃфсѓ▒сЃ╝сѓисЃДсЃ│сѓњУхитІЋсЂЌсЂдсЂёсЂЙсЂЎ..."

# сЃљсЃЃсѓ»сѓесЃ│сЃЅсЂ«ТјЦуХџуб║УфЇ
echo "­ЪЊА сЃљсЃЃсѓ»сѓесЃ│сЃЅсѓхсЃ╝сЃљсЃ╝сЂесЂ«ТјЦуХџсѓњуб║УфЇСИГ..."
if curl -f http://host.docker.internal:8000/health > /dev/null 2>&1; then
    echo "РюЁ сЃљсЃЃсѓ»сѓесЃ│сЃЅсѓхсЃ╝сЃљсЃ╝сЂїтѕЕућетЈ»УЃйсЂДсЂЎ"
else
    echo "Рџа№ИЈ  сЃљсЃЃсѓ»сѓесЃ│сЃЅсѓхсЃ╝сЃљсЃ╝сЂФТјЦуХџсЂДсЂЇсЂЙсЂЏсѓЊсђѓсЃљсЃЃсѓ»сѓесЃ│сЃЅсЂїУхитІЋсЂЌсЂдсЂёсѓІсЂЊсЂесѓњуб║УфЇсЂЌсЂдсЂЈсЂасЂЋсЂёсђѓ"
fi

# DockerсѓцсЃАсЃ╝сѓИсѓњсЃЊсЃФсЃЅ
echo "­Ъће DockerсѓцсЃАсЃ╝сѓИсѓњсЃЊсЃФсЃЅСИГ..."
docker build -t frontend:latest .

# сѓ│сЃ│сЃєсЃісѓњУхитІЋ
echo "­Ъљ│ Dockerсѓ│сЃ│сЃєсЃісѓњУхитІЋСИГ..."
docker run -p 8501:8501 \
  -e BACKEND_URL=http://host.docker.internal:8000 \
  frontend:latest

echo "­ЪјЅ сЃЋсЃГсЃ│сЃѕсѓесЃ│сЃЅсѓбсЃЌсЃфсѓ▒сЃ╝сѓисЃДсЃ│сЂїУхитІЋсЂЌсЂЙсЂЌсЂЪ!"
echo "­ЪЊ▒ сѓбсѓ»сѓ╗сѓ╣URL: http://localhost:8501"
